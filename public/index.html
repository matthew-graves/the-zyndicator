<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Zyn Scanner</title>
<style>
  #container {
    position: relative;
    width: 100%;
    max-width: 600px;
    height: 100%;
  }
  #video {
    width: 100%;
    display: block;
  }
  #canvas {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
  }
      #controls {
      margin-top: 1em;
    }
    #sendBtn {
      padding: 0.5em 1em;
      font-size: 1em;
    }
    #status {
      margin-left: 1em;
      font-family: monospace;
    }
</style>
</style>
</head>
<body>
<div id="container">
  <video id="video" autoplay playsinline muted></video>
  <canvas id="canvas"></canvas>
    <!-- Add this somewhere visible (e.g. overlaid on video) -->
  <div id="ocrOutput"
       style="
         position: absolute;
         bottom: 10px;
         left: 10px;
         color: #fff;
         background: rgba(0,0,0,0.6);
         padding: 6px 10px;
         font-family: monospace;
         font-size: 18px;
         border-radius: 4px;
       ">
    OCR: <span id="ocrText">—</span>
  </div>
    <div id="controls"        style="
         position: absolute;
         bottom: 10px;
         right: 0px;
         color: #fff;
         background: rgba(0,0,0,0.6);
         padding: 6px 10px;
         font-family: monospace;
         font-size: 18px;
         border-radius: 4px;
       ">
    <button id="sendBtn">Submit Code</button>
    <span id="status"></span>
  </div>
</div>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="main.js"></script>
    <script>
    // after main.js has set up the OCR display in #ocrText
    const socket = io();                    // connect to the server
    const btn    = document.getElementById('sendBtn');
    const status = document.getElementById('status');

    btn.addEventListener('click', () => {
      const code = document.getElementById('ocrText').textContent.trim();
      if (!code) {
        status.textContent = '⚠️ no code to send';
        return;
      }
      socket.emit('code', code);
    });

    // listen for acknowledgements from the server
    socket.on('status', msg => {
      status.textContent = msg;
      // clear the status after a few seconds
      setTimeout(() => { status.textContent = ''; }, 3000);
    });
  </script>
</body>
</html>
